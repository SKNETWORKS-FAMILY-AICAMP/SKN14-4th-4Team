{% extends '../layout/base_default.html' %}

{% load static %}

{% block title %}💪 Gym-PT | Talk & Find!{% endblock title %}

{% block upper_script %}
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
{% endblock upper_script %}

{% block style %}
    <link rel="stylesheet" href="{% static 'css/chat.css' %}">
{% endblock style %}

{% block content %}
    <div class="container py-5">
        <!-- 상단 타이틀 카드 -->
        <div class="card mb-4">
            <div class="card-body text-center">
                <p class="h2 text-success fw-bold">💪 Gym-PT와 대화하기</p>
            </div>
        </div>

        <!-- 메인으로 돌아가기 버튼 -->
        <div class="mb-3">
            <a href="{% url 'mainapp:main' %}" class="btn btn-custom rounded-4">← 메인으로</a>
        </div>

        <hr/>

        <div class="container px-0 py-4">
            <div class="card shadow-sm" id="chatLogBox">
                <div class="card-body d-flex flex-column gap-3" id="chatLog">
                    <div class="d-flex">
                        <div class="bg-light text-dark p-3 rounded-4 chatMsg">
                            안녕하세요! 여러분의 PT, 💪 Gym-PT 입니다!<br/>
                            오늘 드신 식단을 찍어 사진과 함께 궁금하신 내용을 알려주시면,<br/>
                            식단 분석과 함께 필요한 운동 코스를 안내해드립니다.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 이미지 업로드 -->
        <form method="post" enctype="multipart/form-data" name="askForm">
            {% csrf_token %}
            <p class="h4 fw-bold mb-2">📝 새로운 메시지</p>
            <p class="text-start">음식 사진을 업로드해주세요 (최대 5개).</p>
            <div id="preview"></div>
            <div class="mb-4">
                <label for="formFile" class="form-label text-secondary">이미지 파일 선택</label>
                <input  id="formFile" class="form-control" type="file" multiple accept="jpg,jpeg,png" name="images">
            </div>

            <!-- 추가 정보 -->
            <p class="text-start">신체 정보와 음식에 대한 추가 정보를 입력해주세요.</p>
            <div class="form-floating mb-4">
                <textarea id="floatingTextarea2" class="form-control" name="user_text"></textarea>
                <label   for="floatingTextarea2">예: 나이 25세, 남성, 키 175cm, 몸무게 70kg, 평소 운동량 중간, 아침에 삶은 계란 2개 먹음...</label>
            </div>

            <!-- 제출 버튼 -->
            <div class="d-grid gap-2 col-6 mx-auto mt-5">
                <a href="javascript:;" id="askBtn" type="button" class="btn btn-custom btn-lg rounded-pill fw-bold">
                    🍽️ 오늘의 식사 입력하기
                </a>
            </div>

            {% include "../layout/loading.html" %}
        </form>

    </div>
{% endblock content %}

{% block script %}
    <script src="{% static "js/chat.js" %}"></script>
{% endblock script %}